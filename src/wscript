#!/bin/env python
# -*- coding: utf-8 -*-

def build(bld):
	import platform

	lib_name_pattern = '%s'
	platform_libs = []

	if platform.system() == 'Windows':
		# waf names static libraries differently on windows for a misguided reason
		lib_name_pattern = 'lib%s'
		platform_libs.append('User32')

	bld.add_subdirs([
		'skin',
		'segment',
		'core',
		'board',
	])

	sources = [
		'player.cpp',
		'snake_direction_listener.cpp',

		'platform-desktop-sdl/main.cpp',
		'platform-desktop-sdl/paths.cpp',
		'platform-desktop-sdl/snygg.cpp',

		'game/food_generator.cpp',
		'game/food_item.cpp',
		'game/item.cpp',
		'game/item_container.cpp',
		'game/item_with_life.cpp',
		'game/snake.cpp',
		'game/digesting_growth_policy.cpp',
		'game/growth_policy.cpp',
		'game/immediate_growth_policy.cpp',
	]

	obj = bld.program(
		source=sources,
		target='snygg',
		use=[
			'ymse',
			'GL',
			'glew',
			'SDL',
			'SDLmain',
			'SDL_image',
			'boost',
			'imlib',

			'board',
			'skin',
			'segment',
			'core',
		],
		lib=[lib_name_pattern % 'boost_filesystem', lib_name_pattern % 'boost_system'] + platform_libs,
		includes=[],
	)
